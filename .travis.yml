language: go
sudo: required

go:
- "1.14"

os: linux

env:
    global:
        - BAZEL_VERSION: 1.2.1

before_install:
    # Install Bazel
  - sudo apt-get update && sudo apt install -y wget g++ unzip zip
  - wget https://github.com/bazelbuild/bazel/releases/download/$BAZEL_VERSION/bazel-$BAZEL_VERSION-installer-linux-x86_64.sh
  - chmod +x bazel-$BAZEL_VERSION-installer-linux-x86_64.sh
  - sudo ./bazel-$BAZEL_VERSION-installer-linux-x86_64.sh
  - bazel version
    # Setup Python 3
  - sudo apt-get install -y python3
  - sudo unlink /usr/bin/python
  - sudo ln -s /usr/bin/python3 /usr/bin/python

before_script:
    # Store GitHub token
  - echo -e "$GH_TOKEN" > /tmp/token.gh

jobs:
  include:
    - stage: "Tests"
      name: "config-test"
      script: echo test1
    - name: "verify-all"
      script: echo test2
    - stage: "Deploy"
      name: "deploy"
      script: echo deploy

script:
  - go version

after_script:
  - rm -f /tmp/token.gh


